.. _technical-overview:
.. highlight:: bash

Technical Overview
==================

Team
----

.. literalinclude:: ../etat_civil/static/humans.txt
    :language: text
    :start-after: /* TEAM */
    :end-before: /* SITE */

Technologies and Processes
--------------------------

Development
^^^^^^^^^^^

For more information see `development`_ and `development with docker`_.

.. _development: https://cookiecutter-django-kingsdigitallab.readthedocs.io/en/latest/developing-locally.html
.. _development with docker: https://cookiecutter-django-kingsdigitallab.readthedocs.io/en/latest/developing-locally-docker.html

Data model
^^^^^^^^^^

.. figure:: _images/models.png
    :align: center
    :alt: Django models
    :figclass: align-center
    :width: 100%

    Django models

The data model graph was generated with the `django-extensions graph_models`_
command::

    $ ./bake.py manage graph_models deeds -X TimeStampedModel  --disable-fields --disable-abstract-fields -o models.png

.. _django-extensions graph_models: https://django-extensions.readthedocs.io/en/latest/graph_models.html

Below is an example of how the model is used to record information on one deed (Etat Civil Ismaïlia 1872-1882).

- Deed:

  - ID: 1; acttype: 1; n: 21; date: 24 déc. 1872; place: 1; source: 1
  
- Person:

  - ID: JMS; name: Joseph Marius Silvy; year of birth: 1842
  - ID: TB; name: Thérèse Blaum; year of birth: 1848

- Party:

  - Deed: 1; person: JMS; role: 2; profession: 2
  - Deed: 1; person: TB; role: 1; profession: 1

- Origin:

  - Person: JMS; place: 2; originype: 1
  - Person: TB; place: 3; origintype: 2
  
- DeedType:

  - 1: Birth
  - 2: Death
  - 3: Marriage
  
- Place:

  - 1: Ismaïlia; Egypt
  - 2: Département de la Haute-Garonne; Saint-Marcel; France
  - 3: Département des Pyrénées-Orientales; Collioure; France

- OriginType:

  - 1: Birth
  - 2: Origin

- Profession:
  - 1: Sans profession
  - 2: Mécanicien
  
- Role:

  - 1: Mother
  - 2: Father
  
- Source:

  - 1: Classmark: Ismaïlia 1; microfilm: P 07070
  - 2: Classmark: Le Caire 1; microfilm: P 06505

Workflows
^^^^^^^^^

TODO: data processing & editorial workflows

Architecture
^^^^^^^^^^^^
TODO: Extract high level description from PQ

.. figure:: _images/docker-local.png
    :align: center
    :alt: Local Docker stack
    :figclass: align-center
    :width: 100%

    Local Docker Stack

The graphs were generated by the docker-compose-viz_ tool::

    $ docker run --rm -it --name dcv -v $(pwd):/input pmsipilot/docker-compose-viz render -m image local.yml

.. _docker-compose-viz: https://github.com/ahmadawais/Emoji-Log

Design process
--------------

TODO: describe design process
